{% extends "base.html" %} {% load static %} {% block PageTitle %}Missing attendance records
{% endblock %} {% block UserName %} {{ UserName}}
{% endblock %} {% block Title %} REPORTS {% endblock %} {% block functionTitle%}MISSING ATTENDANCE RECORDS{% endblock %} {% block content %}

<div >

    <div class="row">
        <div class="col-lg-12">
            <div class="card" id="orderList">
                <div class="card-header border-0">
                    <div class="row align-items-center gy-3">
                        <div class="col-sm">
                            <h5 class="card-title mb-0">Missing attendance records</h5>
                        </div>
                       
                    </div>
                </div>
                <div class="card-body border border-dashed border-end-0 border-start-0">
                    <form   action="{% url 'core:processmissingAttendence' %}"
                    method="POST">
                    {% csrf_token %}
                        <div class="row g-3">
                           
                            <!--end col-->
                            <div class="col-xxl-2 col-sm-6">
                                <div>
                                    {{form.from_date}}
                                </div>
                            </div>

                            <div class="col-xxl-2 col-sm-6">
                                <div>
                                  {{form.to_date}}
                                </div>
                            </div>

                            <!--end col-->
                            
                            <div class="col-xxl-1 col-sm-4">
                                <div>
                                    <button type="submit" class="btn btn-primary w-100" > 
                                        Search
                                    </button>
                                </div>
                            </div>
                            <!--end col-->
                        </div>
                        <!--end row-->
                    </form>
                </div>
                <div class="card-body pt-0">
                    <div>
                        <div class="form-check"></div>
                        
                        <table id="missingRecordsTable" class="table table-striped table-hover" cellspacing="0">
                            <thead>
                              <tr>
                                <th>Child</th>
                                <th>Date</th>
                                <th>Time</th>
                              </tr>
                            </thead>
                            {% for records in list %}
                            {% if records%}
                            {% for record in records %}
                            <tr>
                                <td>{{ record.child }}</td>
                                <td>{{ record.date_logged }}</td>
                                <td>{{ record.time_logged |time:"h:i a"}}</td>
                            </tr>
                            {% endfor %}
                            {% endif %}
                        {% endfor %}
                          </table>
                        
                    </div>
                  
                    
                </div>
            </div>

        </div>
        <!--end col-->
    </div>
    <!--end row-->

</div>


{% endblock %}  {% block scripts %}
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<!--datatable js-->
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

<script src="{% static 'assets/js/pages/datatables.init.js' %}"></script>
<script src="{% static 'assets/libs/node-waves/waves.min.js' %}"></script>
<script src="{% static 'assets/libs/feather-icons/feather.min.js' %}"></script>
<!-- flatpickr -->
<script src="{% static 'assets/libs/flatpickr/flatpickr.min.js' %}"></script>
<script src="{% static 'assets/libs/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets/libs/simplebar/simplebar.min.js' %}"></script>

<script>
  var $ = jQuery;
  var id;
  var dataTable;

  jQuery(document).ready(function () {

    jQuery('#from_date').flatpickr({
                minDate: new Date().fp_incr(-60), 
                maxDate:  "today",
                
            });
    jQuery('#to_date').flatpickr({
                minDate: new Date().fp_incr(-60), 
                maxDate:  new Date().fp_incr(-1), 
                
       });
    
           
    window.setTimeout(function () {
      // Select the inner div with the class "alert" inside the outer div with class "flex-shrink-0"
      var alertDiv = jQuery(".alert");

      // Check if the inner div contains a success message
      var successMessageFound = alertDiv.find(".alert-success").length > 0;

      // If a success message is found, apply the fade-out effect
      if (successMessageFound) {
        alertDiv.fadeTo(1000, 0).slideUp(1000, function () {
          jQuery(this).remove();
        });
      }
    }, 2000);

    var table = $("#missingRecordsTable").DataTable({
      responsive: true,
      dom: "Bfrtip",
            pageLength: 50,

            buttons: ["excel", "print"],
      order: [[1, "asc"]], // Set default sorting by admission_date in descending order
    });
  });



  jQuery("#time_logged").flatpickr({
    enableTime: true,
    noCalendar: true,
    enableSeconds: false,
    dateFormat: "H:i",
    allowInput: true,
  });

  

</script>

<!-- App js -->
<script src="{% static 'assets/js/app.js' %}"></script>

{% endblock %}
